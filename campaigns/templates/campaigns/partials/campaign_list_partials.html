{% load django_bootstrap5 %}

{# Container partial for campaigns - handles empty and populated states #}
{% partialdef campaigns_container %}
{% if campaigns %}
{% partial campaigns_table %}
{% else %}
{% partial empty_state %}
{% endif %}
{% endpartialdef %}

{# Campaigns table #}
{% partialdef campaigns_table %}
<div id="campaigns_table" class="card shadow-sm overflow-hidden">
    <div class="table-responsive">
        <table class="table table-hover table-sm align-middle mb-0">
            <thead>
                <tr>
                    <th scope="col" class="ps-3" style="width: 30%;">Name</th>
                    <th scope="col" style="width: 40%;">Description</th>
                    <th scope="col" class="text-center" style="width: 15%;">Keywords</th>
                    <th scope="col" class="text-end pe-3">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for campaign in campaigns %}
                <tr>
                    <td class="ps-3">
                        <a href="{% url 'campaigns:campaign_detail' campaign.pk %}"
                            class="fw-semibold text-decoration-none text-dark d-block">
                            {{ campaign.name }}
                        </a>
                    </td>
                    <td class="text-muted small">
                        {{ campaign.description|truncatewords:15|default:"<em>No description provided</em>" }}
                    </td>
                    <td class="text-center">
                        <span class="badge bg-secondary bg-opacity-10 text-secondary rounded-pill px-2">
                            {{ campaign.keywords.count }}
                        </span>
                    </td>
                    <td class="text-end pe-3">
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-sm btn-outline-primary border-0" data-bs-toggle="modal"
                                data-bs-target="#editCampaignModal{{ campaign.id }}">
                                <i class="bi bi-pencil-fill me-1"></i>Edit
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-danger border-0" data-bs-toggle="modal"
                                data-bs-target="#deleteCampaignModal{{ campaign.id }}">
                                <i class="bi bi-trash-fill me-1"></i>Delete
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{# Include modals for each campaign #}
{% include "campaigns/partials/campaign_modals.html" %}
{% endpartialdef %}

{# Empty state #}
{% partialdef empty_state %}
<div class="text-center py-5">
    <div class="mb-4">
        <div class="bg-light rounded-circle d-inline-flex align-items-center justify-content-center"
            style="width: 80px; height: 80px;">
            <i class="bi bi-folder2-open text-muted fs-1"></i>
        </div>
    </div>
    <h4 class="text-dark fw-bold">No campaigns yet</h4>
    <p class="text-muted mb-4">Create your first campaign to start monitoring Reddit threads and comments.</p>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createCampaignModal">
        <i class="bi bi-plus-lg me-2"></i>Create Campaign
    </button>
</div>
{% endpartialdef %}

{# Auto-render based on context #}
{% partial campaigns_container %}